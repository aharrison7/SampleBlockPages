<html>
<head>
<title>Example HTML + Javascript Block Page</title>
<!-- We are going to use JQuery to make life a little easier, this can be done -->
<!-- without it, but then it's not so easy, or fun.  Use whatever library you  -->
<!-- are comfortable with.                                                     -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.js"></script>
<!-- These should be stored on your local server and not grabbed remotely like -->
<!-- this.  Download the scripts and place on your block page server or risk   -->
<!-- these guys banning your IPs.  Your call.                                  -->
<script src="http://plugins.jquery.com/files/rotator.js.txt"></script>
<script src="https://raw.github.com/allmarkedup/jQuery-URL-Parser/v1.1/jquery.url.js"></script>

<script language="Javascript">
// It is very important to unescape the information in the query parameters as they will
// be URL encoded.  unescape lends consistent results for the purposes of this exercise

$(function() {
    // Get the domain query parameter, use example.com if we don't have one.
    var domain = $.url.param("url");
    if (domain) {
        domain = $.rotate13(unescape(domain));
        
        // Since the decisions are made only on the domain, let's *just* show the domain.
        domain = /[a-z]+:\/\/([^\/]+)\//i.exec(domain)[1];
    }
    else {
        domain = "www.example.com";
    }
            
    $("#domain").text(domain);
    
    // Set a default type to "block".  This allows us to just referance the block page
    // and see an example of what it would look like without needing extra parameters
    var type = $.url.param("type");
    if (!type)
        type = "block";
    
    // Show the appropriate messaging based on the redirect type
    switch (type) {
        // Blocked Categories/Domains
        case "ablock":
        case "block":
            $("#message").text("was blocked on this network.");
            if ($.url.param("cats")) {
                // categories are an escaped JSON array
                $("#message").append("<br />Blocked Categories: " + $.parseJSON(unescape($.url.param("cats"))).join(", "));
            }
            break;
            
        // Phishing Domains
        case "phish":
            $("#message").text("is believed to be involved in a phishing attack.");
            break;

        default:
            // You should probably log anything like this as it means people are either
            // playing with your block page or OpenDNS added an additional type and you
            // should be checking the documentation to see what it means.
            $("#message").text("is " + type);
            break;
    }
});

</script>
</head>
<body>
<!-- I'm not very stylistic, so this is a very plain block page.  Please feel  -->
<!-- free to do something a little nicer!                                      -->
<span id="domain"></span> <span id="message"></span>
</body>
</html>